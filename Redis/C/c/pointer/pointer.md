### 悬挂指针(野指针)

悬挂指针（Dangling Pointer），也常被称为野指针，是指向不再有效或已被释放的内存位置的指针。在程序设计中，特别是在C和C++这类需要手动管理内存的语言中，悬挂指针是一个常见的问题。

当一个指针指向的内存被释放后，该指针就成为了悬挂指针。这意味着，如果程序继续使用这个指针去访问或修改它所指向的内存，那么程序的行为将是未定义的。具体来说，这可能导致以下几种情况：

- 程序崩溃：尝试访问已被释放的内存可能导致程序抛出异常或直接崩溃，这通常表现为“Segmentation fault”或“Access violation”。
- 数据损坏：如果被释放的内存被重新分配给了其他数据，那么使用悬挂指针可能会修改到新的数据，造成数据损坏。
- 不可预测的行为：使用悬挂指针可能导致程序表现出随机或不可预测的行为，因为指针可能指向任意的内存位置。

为了避免悬挂指针问题，开发者应当注意以下几点：
- 在释放内存后，立即将指针设置为NULL或其它安全值，以避免后续误用。
- 确保指针在使用前已经被正确初始化。
- 使用智能指针（如C++中的std::unique_ptr、std::shared_ptr）等RAII（Resource Acquisition Is Initialization）机制，自动管理资源的生命周期，减少手动管理内存的需求。
例如，在C++中，如果使用原始指针，一旦释放了内存，应该将指针置为nullptr.

悬挂指针是导致程序不稳定和难以调试的常见原因之一，因此在开发过程中应特别注意避免。
下面给出一个简单的示例, 说明悬挂指针的问题:
```c
#include <stdio.h>

int * func() {
    int a = 10;
    int * pa = &a;
    return pa;
}

int * func2() {
    int b = 20;
    int * p = &b;
    return p;
}

int main() {
    int * pa = func();
    printf("pa: addr:%p value: %d\n", pa, *pa);

    int * pb = func2();
    printf("pb: addr:%p value: %d\n", pb, *pb);

    // 重新打印pa
    printf("pa: addr:%p value: %d\n", pa, *pa);

    return 0;
}
```
在上述代码中，func函数返回一个指向局部变量a的指针，而func2函数返回一个指向局部变量b的指针。
当main函数调用这两个函数时，它们返回的指针被保存在pa和pb中。
函数func和func2首次调用打印出的值还是符合预期的, 但是当再次打印pa时, 输出了pb的值. 这样再使用pa时, 就可能会发生错误.
打印的结果中, 我们可以看到, pa和pb的地址为相同的. 因为在func调用完毕后, func的局部变量a被释放了，所以pa指向的地址已经不再有效。
执行func2时, func中申请的地址被pb重复利用了.

解决上述问题, 可以手动分配内存地址, 避免函数结束回收内存的问题.
只需将上述函数修改为如下:
```c
int * func() {
    int * pa = (int *)malloc(sizeof(int));
    int a = 10;
    int * pa = &a;
    return pa;
}

int * func2() {
    int * pb = (int *)malloc(sizeof(int));
    int b = 22;
    int * pb = &b;
    return pb;
}
```


### 指针函数
在C和C++编程语言中，“指针函数”和“函数指针”是两个相关但含义不同的概念。这里我们主要讨论“指针函数”，但也会简要提及“函数指针”以作对比。

指针函数指的是一个返回值类型为指针的函数。换句话说，当一个函数执行完毕后，它返回的是一个指向某个数据类型的指针，而不是数据本身。这种函数通常用于返回动态分配的内存地址，或者返回数组、结构体等复杂数据类型的地址。

一个指针函数的定义通常如下所示：返回类型* 函数名(参数列表);
```c
#include <stdlib.h>

int* createArray(int size) {
    int* arr = (int*)malloc(size * sizeof(int));
    // 初始化数组...
    return arr;
}
```

### 函数指针

函数指针则是完全不同的概念。函数指针是一个指针变量，它可以存储一个函数的地址，这样就可以通过这个指针来调用函数。函数指针在回调函数、事件处理函数等场景中非常有用。

声明一个函数指针的语法如下：返回类型 (*指针变量名)(参数列表);

```c
int add(int a, int b) {
    return a + b;
}

int main() {
    int (*funcPtr)(int, int) = add;
    int result = funcPtr(5, 3);
    return 0;
}
```
在这个例子中，funcPtr是一个指向返回int类型并接收两个int参数的函数的指针。

总结:
- 指针函数返回一个指针作为结果。
- 函数指针是一个指向函数的指针，可以用来调用函数。
